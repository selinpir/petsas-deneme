@* @page "/stock/AddStock"
@page "/stock/AddStock/{id:int}"
@attribute [Authorize(Roles = "Admin,Supplier")]

@using Microsoft.AspNetCore.Authorization
@using MudBlazor
@using petsas2.Models
@using petsas2.Services.Interface

@inject IProductService ProductService
@inject Snackbar Snackbar




<MudNumericField @bind-Value="addAmount[p.ProductId]" Min="1" Max="100" Style="width:80px" />
<MudButton OnClick="() => AddStock(p.ProductId)">Ekle</MudButton>
@code{
    async Task AddStock(int productId, int amount)
    {
        var product = await _context.Products.FindAsync(productId);
        if (product == null)
            throw new Exception("Ürün bulunamadı.");

        var amount = addAmount[productId];
        product.Stock += amount;
        await ProductService.AddStock(productId, amount);
        // Toast
        Snackbar.Add($"Ürün {productId} stokuna {amount} eklendi.", Severity.Success);
        // Listeyi yenile
        alerts = await ProductService.GetStockAlertAsync();
        await _context.SaveChangesAsync();
    }
} *@